        -:    0:Source:randomTestCard1.c
        -:    0:Graph:randomTestCard1.gcno
        -:    0:Data:randomTestCard1.gcda
        -:    0:Runs:1
        -:    0:Programs:1
        -:    1:/*
        -:    2: * This is a random tester of the Smithy card
        -:    3: * 
        -:    4: * 
        -:    5: */
        -:    6:
        -:    7:/* 
        -:    8: * File:   randomTestCard2.c
        -:    9: * Author: Dustin LaGrone
        -:   10: * November 11, 2018
        -:   11: */
        -:   12:
        -:   13:#include <time.h>
        -:   14:#include <assert.h>
        -:   15:#include <stdio.h>
        -:   16:#include <stdlib.h>
        -:   17:#include <string.h>
        -:   18:#include <math.h>
        -:   19:#include "dominion.h"
        -:   20:#include "dominion_helpers.h"
        -:   21:#include "rngs.h"
        -:   22:#define ASSERTTRUE(BoolCondition,__LINE__) do { if (!(BoolCondition)) { aFailed(__LINE__); } \
        -:   23:else{printf("ASSERTION TRUE! line:%d\n",__LINE__);}} while (0)
        -:   24:/*
        -:   25: * Simple C Test Suite
        -:   26: */
        -:   27:
        -:   28:/*Part of the ASSERTTRUE test*/
function aFailed called 233 returned 100% blocks executed 100%
      233:   29:void aFailed(int line){
        -:   30:    
      233:   31:    printf("ASSERTION FALSE! line: %d\n",line);
call    0 returned 100%
      233:   32:}
        -:   33:/*Function takes in Randomized game state and checks values for card*/
function checkSmithyCard called 10000 returned 100% blocks executed 97%
    10000:   34:int checkSmithyCard(int handPos, int player, struct gameState* post){
        -:   35:    
    10000:   36:    post->whoseTurn = player;
        -:   37:    struct gameState pre;
        -:   38:    
    10000:   39:    memcpy(&pre,post, sizeof(struct gameState));
        -:   40:    
    10000:   41:    int* storedDrawCards = (int*)malloc( 3 * sizeof(int));
    10000:   42:    int storedHandPos = post->hand[player][handPos];
    10000:   43:    int topOfDeck = post->deckCount[player] - 1;
        -:   44:    
        -:   45:    /*Check the stored drawn cards from the players deck vs the hand*/
    10000:   46:    if(post->deckCount[player] <= 0){
branch  0 taken 1% (fallthrough)
branch  1 taken 99%
        -:   47:        
       29:   48:        shuffle(player,&pre);
call    0 returned 100%
       29:   49:        topOfDeck = post->deckCount[player] - 1;
        -:   50:        
      116:   51:        for(int i = 0; i < 3; i++){
branch  0 taken 75%
branch  1 taken 25% (fallthrough)
        -:   52:            
       87:   53:            storedDrawCards[i] = pre.deck[player][topOfDeck];
        -:   54:        }   
        -:   55:    }else{
        -:   56:        
    39884:   57:        for(int k = 0; k < 3; k++){
branch  0 taken 75%
branch  1 taken 25% (fallthrough)
    29913:   58:            storedDrawCards[k] = pre.deck[player][topOfDeck];
    29913:   59:            topOfDeck--;
        -:   60:        }
        -:   61:    }
        -:   62:    
    10000:   63:    int drawncards = 0;
        -:   64:    
    10000:   65:    cardEffect(smithy,0,0,0,post,handPos, 0);
call    0 returned 100%
        -:   66:    
    10000:   67:    int handCount = post->handCount[player] - 1;
        -:   68:   
    40000:   69:    for(int k = 2; k >= 0; k--){
branch  0 taken 75%
branch  1 taken 25% (fallthrough)
    30000:   70:        if(storedDrawCards[k] == post->hand[player][handCount]){
branch  0 taken 66% (fallthrough)
branch  1 taken 34%
    19883:   71:            printf("Draw cards Match Hand\n");
call    0 returned 100%
    19883:   72:            drawncards++;
    19883:   73:            handCount--;
        -:   74:         /*Test the discard function for the cards drawn being placed at handPos*/
    10117:   75:        }else if(storedDrawCards[k] == post->hand[player][handPos]){
branch  0 taken 98% (fallthrough)
branch  1 taken 2%
     9963:   76:            printf("Draw cards Match Hand\n");
call    0 returned 100%
     9963:   77:            drawncards++;
        -:   78:        }
        -:   79:    }      
        -:   80:       
        -:   81:    /*Checks that three cards drawn from deck match cards in hand*/
    10000:   82:    ASSERTTRUE(drawncards == 3,__LINE__);
branch  0 taken 1% (fallthrough)
branch  1 taken 99%
call    2 returned 100%
call    3 returned 100%
        -:   83:    
        -:   84:    /*Check that three cards were drawn with one discard*/
    10000:   85:    ASSERTTRUE(pre.handCount[player] + 2 == post->handCount[player],__LINE__);
branch  0 taken 1% (fallthrough)
branch  1 taken 99%
call    2 returned 100%
call    3 returned 100%
    10000:   86:    if(pre.handCount[player] + 2 != post->handCount[player]){
branch  0 taken 1% (fallthrough)
branch  1 taken 99%
       77:   87:        printf("Pre Hand:%d\nPost Hand:%d\n", pre.handCount[player],post->handCount[player]);
call    0 returned 100%
        -:   88:    }
        -:   89:    /*Check that the card from hand position was discarded*/
   10000*:   90:    ASSERTTRUE(post->playedCards[post->playedCardCount - 1] == storedHandPos,__LINE__);
branch  0 taken 0% (fallthrough)
branch  1 taken 100%
call    2 never executed
call    3 returned 100%
        -:   91:    
    10000:   92:    return 0;
        -:   93:    
        -:   94:}
function test1 called 1 returned 100% blocks executed 98%
        1:   95:void test1() {
        -:   96:
        -:   97:    struct gameState state;
        -:   98:    
        -:   99:        /*Random Game Initialization Borrowed from betterTestDrawCard.c*/
        1:  100:        SelectStream(2);
call    0 returned 100%
        1:  101:        PutSeed(3);
call    0 returned 100%
        -:  102:    
    10001:  103:    for(int numberOfRun = 0; numberOfRun <  10000; numberOfRun++){
branch  0 taken 99%
branch  1 taken 1% (fallthrough)
        -:  104:        
    10000:  105:                int  player = floor(Random() * MAX_PLAYERS);
call    0 returned 100%
        -:  106:        
    10000:  107:        state.whoseTurn = player;
        -:  108:        
        -:  109:        /*Modify the Deck with randomly initlized values
        -:  110:         * To check if the adventurer function is selecting 
        -:  111:         * Copper, Silver or Gold*/
    10000:  112:        state.deckCount[player] = floor(Random() * MAX_DECK);
call    0 returned 100%
    10000:  113:        state.playedCardCount = 0;
        -:  114:       
  2494184:  115:        for(int i = 0; i < state.deckCount[player]; i++){
branch  0 taken 99%
branch  1 taken 1% (fallthrough)
        -:  116:          
  2484184:  117:            state.deck[player][i] = floor(Random() * 27);
call    0 returned 100%
        -:  118:        }
        -:  119:        
    10000:  120:        state.handCount[player] = floor(Random() * MAX_HAND);
call    0 returned 100%
        -:  121:        
        -:  122:        
        -:  123:        /*Randomize each card in randomized hand count*/
  2484129:  124:        for(int k = 1; k < state.handCount[player]; k++){
branch  0 taken 99%
branch  1 taken 1% (fallthrough)
  2474129:  125:            state.hand[player][k] = floor(Random() * 100);
call    0 returned 100%
        -:  126:        }
        -:  127:        /*Randomly initiate a discard Pile with cards*/
    10531:  128:        for(int a = 0; a < state.discardCount[player]; a++){
branch  0 taken 5%
branch  1 taken 95% (fallthrough)
      531:  129:            state.discard[player][a] = floor(Random() * 27);
call    0 returned 100%
        -:  130:        
        -:  131:        }
        -:  132:        /*Randomly Distribute Supply*/
   280000:  133:        for(int m = 0; m < 27; m++){
branch  0 taken 96%
branch  1 taken 4% (fallthrough)
   270000:  134:            state.supplyCount[m] = floor(Random() * 27);
call    0 returned 100%
        -:  135:        }
        -:  136:        
    10000:  137:        int handPos = 0;
        -:  138:        /*Add the Adventurer card to the players hand to be used*/
  2494101:  139:        for(int x = 0; x < state.handCount[player]; x++){
branch  0 taken 99%
branch  1 taken 1% (fallthrough)
  2484101:  140:            if(state.hand[player][x] == smithy){
branch  0 taken 1% (fallthrough)
branch  1 taken 99%
    24615:  141:                handPos = x;
    24615:  142:                printf("Smithy found in Hand!!!\n");
call    0 returned 100%
        -:  143:            }
        -:  144:        }
    10000:  145:        if(handPos == 0){
branch  0 taken 21% (fallthrough)
branch  1 taken 79%
        -:  146:            
     2051:  147:            ASSERTTRUE(gainCard(smithy,&state,2,player)== 0,__LINE__);
call    0 returned 100%
branch  1 taken 4% (fallthrough)
branch  2 taken 96%
call    3 returned 100%
call    4 returned 100%
     2051:  148:            handPos = state.handCount[player] - 1;
     2051:  149:            printf("Smithy Added to Hand!!!\n");        
call    0 returned 100%
        -:  150:        }
   10000*:  151:        ASSERTTRUE(checkSmithyCard(handPos, player, &state)== 0,__LINE__);
call    0 returned 100%
branch  1 taken 0% (fallthrough)
branch  2 taken 100%
call    3 never executed
call    4 returned 100%
        -:  152:        
        -:  153:        }
        1:  154:}
        -:  155:
        -:  156:
function main called 1 returned 100% blocks executed 100%
        1:  157:int main(int argc, char** argv) {
        -:  158:     
        1:  159:    printf("%%SUITE_STARTING%% randomtestcard2\n");
call    0 returned 100%
        -:  160:
        1:  161:    printf("%%TEST_STARTED%% test1\n");
call    0 returned 100%
        -:  162:    
        -:  163:    clock_t start, stop;
        -:  164:    
        1:  165:    start = clock();
call    0 returned 100%
        1:  166:    test1();
call    0 returned 100%
        1:  167:    stop = clock();
call    0 returned 100%
        -:  168:    
        1:  169:    double totalTime = ((double)(stop - start) / CLOCKS_PER_SEC);
        -:  170:   
        1:  171:    printf("%%TEST_FINISHED%% \n");
call    0 returned 100%
        -:  172:    
        1:  173:    printf("Time taken:%.3f\n", totalTime);
call    0 returned 100%
        -:  174:
        1:  175:    printf("%%SUITE_FINISHED%% \n");
call    0 returned 100%
        -:  176:
        1:  177:    return (EXIT_SUCCESS);
        -:  178:}
